<div class="notepad-app">
    <div class="notepad-toolbar">
        <div class="toolbar-group">
            <button class="notepad-btn" onclick="newNote()" title="æ–°è¦ä½œæˆ">
                ğŸ“„ æ–°è¦
            </button>
            <button class="notepad-btn" onclick="saveNote()" title="ä¿å­˜">
                ğŸ’¾ ä¿å­˜
            </button>
            <button class="notepad-btn" onclick="loadNote()" title="èª­ã¿è¾¼ã¿">
                ğŸ“‚ é–‹ã
            </button>
        </div>
        <div class="toolbar-group">
            <button class="notepad-btn" onclick="clearNote()" title="ã‚¯ãƒªã‚¢">
                ğŸ—‘ï¸ ã‚¯ãƒªã‚¢
            </button>
            <button class="notepad-btn" onclick="toggleWordWrap()" title="æŠ˜ã‚Šè¿”ã—">
                ğŸ“ æŠ˜ã‚Šè¿”ã—
            </button>
        </div>
        <div class="toolbar-info">
            <span id="char-count">0 æ–‡å­—</span>
        </div>
    </div>

    <textarea id="notepad-content" class="notepad-textarea"
        placeholder="ãƒ¡ãƒ¢ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„...&#10;&#10;â€¢ Ctrl+S ã§ä¿å­˜&#10;â€¢ è‡ªå‹•ã§æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ&#10;â€¢ å†…å®¹ã¯è‡ªå‹•ä¿å­˜ã•ã‚Œã¾ã™"
        oninput="updateCharCount()"></textarea>

    <div class="notepad-status">
        <span id="save-status">æœªä¿å­˜</span>
        <span id="line-info">è¡Œ: 1, åˆ—: 1</span>
    </div>
</div>

<style>
    .notepad-app {
        height: 100%;
        display: flex;
        flex-direction: column;
        background: #ffffff;
    }

    .notepad-toolbar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 12px;
        background: #f8f9fa;
        border-bottom: 1px solid #dee2e6;
        flex-wrap: wrap;
        gap: 10px;
    }

    .toolbar-group {
        display: flex;
        gap: 5px;
    }

    .notepad-btn {
        padding: 6px 12px;
        border: 1px solid #ced4da;
        background: white;
        border-radius: 4px;
        cursor: pointer;
        font-size: 12px;
        transition: all 0.2s ease;
    }

    .notepad-btn:hover {
        background: #e9ecef;
        border-color: #adb5bd;
    }

    .notepad-btn:active {
        background: #dee2e6;
    }

    .toolbar-info {
        font-size: 12px;
        color: #6c757d;
    }

    .notepad-textarea {
        flex: 1;
        border: none;
        padding: 15px;
        font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
        font-size: 14px;
        line-height: 1.5;
        resize: none;
        outline: none;
        background: #ffffff;
    }

    .notepad-textarea:focus {
        background: #fdfdfd;
    }

    .notepad-status {
        display: flex;
        justify-content: space-between;
        padding: 4px 12px;
        background: #f8f9fa;
        border-top: 1px solid #dee2e6;
        font-size: 11px;
        color: #6c757d;
    }

    #save-status.saved {
        color: #28a745;
    }

    #save-status.unsaved {
        color: #dc3545;
    }
</style>

<script>
    let notepadContent = '';
    let isWordWrapEnabled = true;

    // æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆæ›´æ–°
    function updateCharCount() {
        const textarea = document.getElementById('notepad-content');
        const charCount = document.getElementById('char-count');
        const saveStatus = document.getElementById('save-status');
        const lineInfo = document.getElementById('line-info');

        if (textarea && charCount) {
            charCount.textContent = `${textarea.value.length} æ–‡å­—`;
        }

        if (saveStatus) {
            saveStatus.textContent = 'æœªä¿å­˜';
            saveStatus.className = 'unsaved';
        }

        // ã‚«ãƒ¼ã‚½ãƒ«ä½ç½®æƒ…å ±
        if (textarea && lineInfo) {
            const lines = textarea.value.substr(0, textarea.selectionStart).split('\n');
            const currentLine = lines.length;
            const currentCol = lines[lines.length - 1].length + 1;
            lineInfo.textContent = `è¡Œ: ${currentLine}, åˆ—: ${currentCol}`;
        }
    }

    // æ–°è¦ä½œæˆ
    function newNote() {
        if (confirm('ç¾åœ¨ã®å†…å®¹ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã™ã‹ï¼Ÿ')) {
            document.getElementById('notepad-content').value = '';
            updateCharCount();
        }
    }

    // ãƒ¡ãƒ¢ä¿å­˜
    function saveNote() {
        const content = document.getElementById('notepad-content');
        const saveStatus = document.getElementById('save-status');

        if (content) {
            localStorage.setItem('notepad-content', content.value);
            localStorage.setItem('notepad-saved-time', new Date().toLocaleString());

            if (saveStatus) {
                saveStatus.textContent = 'ä¿å­˜æ¸ˆã¿';
                saveStatus.className = 'saved';
            }

            // ä¸€æ™‚çš„ã«ä¿å­˜ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
            const originalText = saveStatus.textContent;
            saveStatus.textContent = 'ä¿å­˜ã—ã¾ã—ãŸï¼';
            setTimeout(() => {
                saveStatus.textContent = originalText;
            }, 2000);
        }
    }

    // ãƒ¡ãƒ¢èª­ã¿è¾¼ã¿
    function loadNote() {
        const savedContent = localStorage.getItem('notepad-content');
        const savedTime = localStorage.getItem('notepad-saved-time');
        const content = document.getElementById('notepad-content');

        if (savedContent && content) {
            content.value = savedContent;
            updateCharCount();

            if (savedTime) {
                alert(`ãƒ¡ãƒ¢ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ\nä¿å­˜æ—¥æ™‚: ${savedTime}`);
            } else {
                alert('ãƒ¡ãƒ¢ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ');
            }
        } else {
            alert('ä¿å­˜ã•ã‚ŒãŸãƒ¡ãƒ¢ãŒã‚ã‚Šã¾ã›ã‚“');
        }
    }

    // ã‚¯ãƒªã‚¢
    function clearNote() {
        if (confirm('ãƒ¡ãƒ¢ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã™ã‹ï¼Ÿ')) {
            document.getElementById('notepad-content').value = '';
            updateCharCount();
        }
    }

    // æŠ˜ã‚Šè¿”ã—åˆ‡ã‚Šæ›¿ãˆ
    function toggleWordWrap() {
        const textarea = document.getElementById('notepad-content');
        if (textarea) {
            isWordWrapEnabled = !isWordWrapEnabled;
            textarea.style.whiteSpace = isWordWrapEnabled ? 'pre-wrap' : 'pre';
            textarea.style.overflowX = isWordWrapEnabled ? 'hidden' : 'auto';
        }
    }

    // Ctrl+S ã§ä¿å­˜
    document.addEventListener('keydown', function (e) {
        if (e.ctrlKey && e.key === 's') {
            e.preventDefault();
            saveNote();
        }
    });

    // åˆæœŸåŒ–
    setTimeout(() => {
        updateCharCount();

        // è‡ªå‹•ä¿å­˜ã•ã‚ŒãŸå†…å®¹ãŒã‚ã‚Œã°èª­ã¿è¾¼ã¿
        const savedContent = localStorage.getItem('notepad-content');
        const textarea = document.getElementById('notepad-content');
        if (savedContent && textarea && !textarea.value) {
            textarea.value = savedContent;
            updateCharCount();
        }
    }, 100);
</script>