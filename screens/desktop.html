<div id="desktop" class="screen active">
    <!-- ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¢ã‚¤ã‚³ãƒ³ -->
    <div class="desktop-icons">
        <div class="desktop-icon" ondblclick="launchApp('calculator')">
            <div class="desktop-icon-image">ğŸ§®</div>
            <span class="desktop-icon-label">é›»å“</span>
        </div>
        <div class="desktop-icon" ondblclick="launchApp('notepad')">
            <div class="desktop-icon-image">ğŸ“</div>
            <span class="desktop-icon-label">ãƒ¡ãƒ¢å¸³</span>
        </div>
        <div class="desktop-icon" ondblclick="launchApp('filemanager')">
            <div class="desktop-icon-image">ğŸ“</div>
            <span class="desktop-icon-label">ãƒ•ã‚¡ã‚¤ãƒ«</span>
        </div>
        <div class="desktop-icon" ondblclick="launchApp('systeminfo')">
            <div class="desktop-icon-image">â„¹ï¸</div>
            <span class="desktop-icon-label">ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±</span>
        </div>
    </div>

    <!-- ã‚¿ã‚¹ã‚¯ãƒãƒ¼ -->
    <div class="taskbar">
        <!-- ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ -->
        <div class="start-button" onclick="toggleStartMenu()">
            <span>ğŸ  ã‚¹ã‚¿ãƒ¼ãƒˆ</span>
        </div>

        <!-- å®Ÿè¡Œä¸­ã®ã‚¢ãƒ—ãƒªè¡¨ç¤ºã‚¨ãƒªã‚¢ -->
        <div class="running-apps" id="running-apps">
            <!-- å‹•çš„ã«è¿½åŠ ã•ã‚Œã‚‹ -->
        </div>

        <!-- ã‚·ã‚¹ãƒ†ãƒ æƒ…å ± -->
        <div class="system-tray">
            <span id="taskbar-time"></span>
            <div class="system-icon" onclick="launchApp('taskmanager')">ğŸ“Š</div>
            <div class="system-icon" onclick="lockScreen()">ğŸ”’</div>
        </div>
    </div>

    <!-- ã‚¹ã‚¿ãƒ¼ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ -->
    <div id="start-menu" class="start-menu hidden">
        <div class="start-menu-header">
            <span id="start-user-name">ãƒ¦ãƒ¼ã‚¶ãƒ¼</span>
        </div>
        <div class="start-menu-items">
            <div class="start-menu-item" onclick="launchApp('calculator')">
                <span class="start-menu-icon">ğŸ§®</span>
                <span>é›»å“</span>
            </div>
            <div class="start-menu-item" onclick="launchApp('notepad')">
                <span class="start-menu-icon">ğŸ“</span>
                <span>ãƒ¡ãƒ¢å¸³</span>
            </div>
            <div class="start-menu-item" onclick="launchApp('filemanager')">
                <span class="start-menu-icon">ğŸ“</span>
                <span>ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼</span>
            </div>
            <div class="start-menu-separator"></div>
            <div class="start-menu-item" onclick="launchApp('settings')">
                <span class="start-menu-icon">âš™ï¸</span>
                <span>è¨­å®š</span>
            </div>
            <div class="start-menu-item" onclick="lockScreen()">
                <span class="start-menu-icon">ğŸ”’</span>
                <span>ãƒ­ãƒƒã‚¯</span>
            </div>
            <div class="start-menu-item" onclick="shutdownSystem()">
                <span class="start-menu-icon">ğŸ”´</span>
                <span>ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³</span>
            </div>
        </div>
    </div>
</div>

<script>
    // ã‚¿ã‚¹ã‚¯ãƒãƒ¼ã®æ™‚åˆ»è¡¨ç¤º
    function updateTaskbarTime() {
        const now = new Date();
        const timeString = now.toLocaleTimeString('ja-JP', {
            hour: '2-digit',
            minute: '2-digit'
        });
        const timeElement = document.getElementById('taskbar-time');
        if (timeElement) {
            timeElement.textContent = timeString;
        }
    }

    // ã‚¹ã‚¿ãƒ¼ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®è¡¨ç¤º/éè¡¨ç¤º
    function toggleStartMenu() {
        const startMenu = document.getElementById('start-menu');
        if (startMenu) {
            startMenu.classList.toggle('hidden');
        }
    }

    // ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±è¡¨ç¤º
    function showSystemInfo() {
        launchApp('systeminfo');
    }

    // ã‚¿ã‚¹ã‚¯ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼è¡¨ç¤º
    function showTaskManager() {
        launchApp('taskmanager');
    }

    // è¨­å®šè¡¨ç¤º
    function showSettings() {
        launchApp('settings');
    }

    // ãƒ­ãƒƒã‚¯ç”»é¢ã«æˆ»ã‚‹
    function lockScreen() {
        if (window.os) {
            window.os.switchScreen('lock');
        }
    }

    // ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³
    function shutdownSystem() {
        if (confirm('ã‚·ã‚¹ãƒ†ãƒ ã‚’ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³ã—ã¾ã™ã‹ï¼Ÿ')) {
            window.location.reload();
        }
    }

    // ã‚¹ã‚¿ãƒ¼ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’å¤–ã‚¯ãƒªãƒƒã‚¯ã§é–‰ã˜ã‚‹
    document.addEventListener('click', function (e) {
        const startMenu = document.getElementById('start-menu');
        const startButton = document.querySelector('.start-button');

        if (startMenu && !startMenu.contains(e.target) && !startButton.contains(e.target)) {
            startMenu.classList.add('hidden');
        }
    });

    // æ™‚åˆ»æ›´æ–°ã‚’é–‹å§‹
    updateTaskbarTime();
    setInterval(updateTaskbarTime, 1000);
</script>